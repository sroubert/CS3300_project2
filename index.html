<html>

<!-- sr949, dc652, kat86 Project 2 -->

<head>

    <style>
        svg {
            border: solid black 1px;
        }
        
        path {
            stroke: black
        }
    </style>

    <title>CS 3300 Project 2</title>

    <link href="https://fonts.googleapis.com/css?family=Alegreya|Alegreya+Sans" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="http://d3js.org/topojson.v2.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>


</head>

<body>


    <script>
        ///asdjhsajdhajshdjkhsdjk


        var deats = {};
        var locations = {};



        var parseRow = function (row) {
            row.EVENT_ID = Number(row.EVENT_ID);
            return row;
        }

        function convertToMonetaryVals(string) {
            if (string.includes("k") || string.includes("m")) {
                    if (string.includes("k")) {
                        string = string.replace("k", ""); console.log(string); return Number(string) * 1000;
                    } else {
                        string = string.replace("m", ""); return Number(string) * 1000000;
                    }
                } else {
                    return string; 
                }
            }

            d3.queue()
                .defer(d3.csv, "StormEvents_details_d2016_steamlined_first.csv", parseRow)
                .defer(d3.csv, "StormEvents_locations-ftp_v1.0_d2016_c20170317.csv", parseRow)
                .await(function (error, rawDetails, rawLocations) {

                    rawDetails.forEach(function (detail) {
                        deats[detail.EVENT_ID] = detail;



                    })

                    rawLocations.forEach(function (location) {
                        locations[location.EVENT_ID] = location;
                    })

                });
        
    </script>
    
    <div id="map"></div>    
    
    <script>

    var states;
    var deats = {};
    var locations = {};
    
    var parseRow = function (row) {
	    row.EVENT_ID = Number(row.EVENT_ID);
	    return row;
    }
    
    d3.queue()
    .defer(d3.json, "us.json")
    .defer(d3.csv, "StormEvents_details_d2016_steamlined_first.csv", parseRow)
    .defer(d3.csv, "StormEvents_locations-ftp_v1.0_d2016_c20170317.csv", parseRow)
    .await(function (error, rawMap, rawDetails, rawLocations) {

    	states = (topojson.feature(rawMap, rawMap.objects.states)).features;
    	rawDetails.forEach(function(detail) {
    		deats[detail.EVENT_ID] = detail;
    	})

    	rawLocations.forEach(function(location) {
    		locations[location.EVENT_ID] = location;
    	})

    	createMap();
        
    });

    var width = 800,
        height = 800;

    function createMap() {
    	var projection = d3.geoMercator();
    	var path = d3.geoPath().projection(projection);

    	var svg = d3.select("map").append("svg")
    	    .attr("width", width)
    	    .attr("height", height);
    }

    </script>

</body>

</html>